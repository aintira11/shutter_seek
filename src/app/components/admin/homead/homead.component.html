<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- chat icon -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

</head>

<body>
    <div class="admin-container">
        <header class="admin-header">
            <div class="admin-profile">
              <img class="profile-avatar" [src]="datauser[0].image_profile" alt="Admin Profile" title="{{datauser[0].username}}" (click)="profile()"/>
              <span class="profile-name">{{ datauser[0].username }}</span>
              <button class="add-btn" (click)="goToadd()">+</button>
            </div>
          
            <div class="logo-center" >
              <img  src="/assets/images/PIXEL (8).png" alt="Shutter Seek Logo" class="center-logo" />
            </div>
          
            <button class="logout-btn" (click)="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          </header>          
          
<div style="position: relative; display: flex; justify-content: center; align-items: center; height: 100px;">
  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏ã‡πâ‡∏≤‡∏¢ -->
  <button 
    mat-raised-button 
    color="primary" 
    (click)="gotohome()" 
    style="position: absolute; left: 20px;">
    üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
  </button>

  <!-- ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
  <h1 style="margin: 0;">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h1>
</div>


        <!--search-container -->
<div class="search-container">
    <input 
        type="text" 
        placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ | ‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡πå | ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£" 
        [(ngModel)]="searchKeyword"
        (keypress)="onSearchKeyPress($event)"
        (input)="searchUsers()"
    />
    <button class="button" (click)="searchUsers()">
        <i class="fa fa-search"></i>
    </button>
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <button class="button clear-btn" *ngIf="isSearching" (click)="clearSearch()" title="‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤">
        <i class="fa fa-times"></i>
    </button>
    
    <div class="button-group">
        <button class="pushable" (click)="openCategoryModal()">
            <span class="shadow"></span>
            <span class="edge"></span>
            <span class="front">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>
        </button>
        <button class="pushable pushable-approve" (click)="goToConfirmShutter()">
            <span class="shadow"></span>
            <span class="edge"></span>
            <span class="front"> ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û </span>
        </button>                  
    </div>
</div>
    
<!-- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô tabs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
<div class="tabs">
  <button 
    (click)="filterUsers(0)" 
    [class.active]="selectedTab === 'all'" 
    [class.searching]="isSearching"
    [class.disabled]="false">
    {{ isSearching ? '‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤' : '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' }} ({{ datafilterUsers.length }})
  </button>
  
  <button 
    (click)="!isSearching && filterUsers(3)" 
    [class.active]="selectedTab === '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö'" 
    [class.disabled]="isSearching"
    [disabled]="isSearching">
    ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö({{ adminCount }})
  </button>
  
  <button 
    (click)="!isSearching && filterUsers(1)" 
    [class.active]="selectedTab === '‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å'" 
    [class.disabled]="isSearching"
    [disabled]="isSearching">
    ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ({{ memberCount }})
  </button>
  
  <button 
    (click)="!isSearching && filterUsers(2)" 
    [class.active]="selectedTab === '‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û'" 
    [class.disabled]="isSearching"
    [disabled]="isSearching">
    ‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û ({{ photographerCount }})
  </button>
  
  <button 
    (click)="!isSearching && filterUsers(4)" 
    [class.active]="selectedTab === '‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡∏π‡πà'" 
    [class.disabled]="isSearching"
    [disabled]="isSearching">
    ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡∏π‡πà ({{ MandP }})
  </button>
</div>
 
    
        <div class="user-list" >
            <div *ngFor="let user of datafilterUsers" >
                <div  *ngIf="user.type_user != '5'"class="user-card" >
                <img [src]="user.image_profile" alt="User Avatar" class="avatar" />
                <div class="user-info">
                    <h3>{{ user.username }}</h3>
                    <p class="role" *ngIf="user.type_user == '1' ">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</p>
                    <p class="role" *ngIf="user.type_user == '2' && user.sht_status == 1">‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û (‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥)</p>
                    <p class="role" *ngIf="user.type_user == '2' && user.sht_status == 2">‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û (‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß)</p>
                    <p class="role" *ngIf="user.type_user == '2' && user.sht_status == 3">‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û (‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò)</p>
                    <p class="role" *ngIf="user.type_user == '3'">‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</p>
                    <p class="role" *ngIf="user.type_user == '4'">‡∏ä‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</p>
                </div>

                <div class="actions">
                    <button *ngIf="user.type_user === '2' || user.type_user === '4' " class="report-btn" (click)="openReportDialog(user.user_id,user.username)">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ({{user.report_count}})</button>
                    <button  class="detail-btn" (click)="toShutter(user.user_id,user.type_user)">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                    <button class="delete-btn" (click)="deleteUser(user.user_id)">
                        <i class="fa fa-trash"></i>
                    </button>
                </div>
            </div>
            </div>
        </div>  

        <!-- Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô -->
        <div class="modal" *ngIf="isCategoryModal">
            <div class="modal-content">
                <p>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</p>
                <hr />
                <div class="category-list">
                    <div *ngFor="let category of jobCategories; let i = index" class="category-item">
                        <input [(ngModel)]="jobCategories[i].name_tags" type="text" [readonly]="!isEditing[i]" />
                        <button class="edit-btn" *ngIf="!isEditing[i]" (click)="enableEditing(i)">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button class="save-btn" *ngIf="isEditing[i]" (click)="saveEdit(i)">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    </div>
                    <div class="category-item">
                        <input [(ngModel)]="newCategory" type="text" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏´‡∏°‡πà" />
                        <button class="addd-btn" (click)="addCategory()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="close-btn" (click)="closeCategoryModal()">‡∏õ‡∏¥‡∏î</button>
                </div>
            </div>
        </div>

        <!-- Modal ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô -->
        <div class="modal" *ngIf="isModal">
            <div class="modal-content">
            <h2>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ : <strong>{{ sht_username }}</strong></h2>
            <hr />
            <p>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î {{ dataReport.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
            <div class="report-list"*ngIf="dataReport.length > 0">
                <div *ngFor="let report of dataReport" class="report-item">
                <strong>{{ report.reporter_username }}  | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• : {{report.reason}}</strong>
                <p>{{ report.details }}</p>
                </div>
            </div>
            <div class="modal-actions">
                <button class="close-btn" (click)="closeModal()">‡∏õ‡∏¥‡∏î</button>
            </div>
            </div>
        </div>

        <!-- model profile -->
         <div class="modal" *ngIf="isModalprofile">
            <div class="profile-container" *ngIf="getprofile">
                  <div class="profile-card">
                      <img [src]="getprofile[0].image_profile" alt="Profile Image" class="profile-image" />
                      <div class="profile-info">
                      <h2 class="username">{{ getprofile[0].username }}</h2>
                        <p class="follow-info" *ngIf="getprofile[0].type_user == '1'">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ </p>
                        <p class="follow-info" *ngIf="getprofile[0].type_user == '3'">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ : ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö </p>
                        <p class="follow-info">‡∏≠‡∏µ‡πÄ‡∏°‡∏• : {{ getprofile[0].email }} </p>
                        <p class="follow-info">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ : {{ getprofile[0].phone }} </p>
                        <p class="member-since">‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà {{ getprofile[0].date_of_member | date:'dd/MM/yyyy'}}</p>
                      
                    </div>
                    
                  </div>                
                </div>  
                <div class="modal-actions">
                     <button class="close-btn" (click)="closeModal()">‡∏õ‡∏¥‡∏î</button>
                 </div>   
         </div>
   </div>

    <!-- Chat Icon  -->
    <div class="fixed-chat-icon-container" (click)="chat(datauser[0].user_id)">
      <i class="bi bi-chat-dots-fill fixed-chat-icon"></i>
      <span *ngIf="hasUnreadMessages" class="notification-badge"></span>
    </div>

</body>
</html>